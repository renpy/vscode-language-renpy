information_for_contributors:
- Please remember to regenerate the ts token patterns using the 'syntax-to-token-pattern.py'
  python script
$schema: https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json
name: Ren'Py Style
scopeName: source.renpy.style
patterns:
- include: '#style'
repository:
  builtin-styles:
    patterns:
    - name: support.type.builtin.style.renpy
      match: \b(?<!\.)(?:(alt)?ruby_style)\b
  style-block-tester:
    patterns:
    - contentName: meta.style-block.renpy
      begin: (?<=(^[ \t]*)(?:style)\b.*?)(:)
      beginCaptures:
        2:
          name: punctuation.section.style.begin.renpy
      end: ^(?=(?!\1)[ \t]*[^\s#]|\1[^\s#])
      patterns:
      - include: '#style-clause'
      - include: source.renpy#fallback-patterns
  style-property:
    patterns:
    - comment: 'ON EDIT: If you update this list, also update it in style-clause'
      name: support.constant.property-key.renpy entity.name.tag.css.style.renpy
      match: \b(?<!\.)(?:(?:selected_)?(?:hover_|idle_|insensitive_|activate_)?(?:STYLE_PROPERTIES))\b
    - name: support.type.builtin.style.renpy
      match: \b(?<!\.)(?:(alt)?ruby_style)\b
    - name: support.constant.property-key.renpy entity.name.tag.css.style.renpy
      match: \b(?<!\.)(?:properties)\b
    - comment: Any other tokens are invalid
      match: .+
      name: invalid.illegal.style-property.name.renpy
  style-clause:
    patterns:
    - comment: is statement
      begin: \b(?<!\.)(is)\b
      beginCaptures:
        1:
          name: keyword.operator.logical.python
      end: (?!\G)(?<=[^ \t])|$
      patterns:
      - name: entity.name.type.style.base.renpy
        match: \b[\p{XID_Start}_]\p{XID_Continue}*\b
      - include: source.renpy#fallback-patterns
    - match: \b(?<!\.)clear\b
      name: keyword.clear.renpy
    - begin: \b(?<!\.)(take)\b
      beginCaptures:
        1:
          name: keyword.take.renpy
      end: (?!\G)(?<=[^ \t])|$
      patterns:
      - include: source.renpy#name
      - include: source.renpy#fallback-patterns
    - match: \b(?<!\.)(del)\b[ \t]*(\w*)
      captures:
        1:
          name: keyword.del.renpy
        2:
          patterns:
          - include: '#style-property'
    - begin: \b(?<!\.)(variant)\b
      end: (?!\G)
      beginCaptures:
        1:
          name: keyword.variant.renpy
      patterns:
      - include: source.renpy#simple-expression
    - comment: 'ON EDIT: If you update this list, also update it in style-property'
      begin: \b(?<!\.)(properties|(?:(?:selected_)?(?:hover_|idle_|insensitive_|activate_)?(?:STYLE_PROPERTIES)))\b
      end: (?!\G)|$
      beginCaptures:
        1:
          name: support.constant.property-key.renpyx entity.name.tag.css.style.renpy
      patterns:
      - include: source.renpy#simple-expression
  style:
    comment: See https://www.renpy.org/doc/html/styles.html
    name: meta.style.statement.renpy
    contentName: meta.style.parameters.renpy
    begin: (?<=^[ \t]*)(style)\b
    beginCaptures:
      1:
        name: storage.type.style.renpy
    end: $|^
    patterns:
    - include: '#builtin-styles'
    - comment: Only the first identifier is a style name
      name: entity.name.type.style.renpy
      match: (?<=\bstyle[ \t]*)\b[\p{XID_Start}_]\p{XID_Continue}*\b
    - include: '#style-clause'
    - include: '#style-block-tester'
    - include: source.renpy#fallback-patterns
